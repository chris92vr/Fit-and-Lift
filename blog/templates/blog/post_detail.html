{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<section class="blog ">
   <div class="blog-container container-fluid">
      <div class="blog-header text-center mb-3">
         <h1 class="blog-title">Fit and Lift Blog</h1>
         <p class="lead blog-description">The official blog</p>
      </div>
      <div class="row">
         <!-- Post Content Column -->
         <div class="col-sm-8 col">
            <!-- Title -->
            <h1 class="mt-4">{{ post.title }}</h1>
            <!-- Author -->
            <p class="lead">
               by
               {{ post.created_by }} 
            </p>
            <hr>
            <!-- Date/Time -->
            <p>Posted on  {{ post.created_on }}</p>
            <hr>
            {% if post.image %}
            <img class="card-img-top img-fluid mb-4" src="{{ post.image.url }}" alt="{{ post.title }}">
            {% else %}
            <img class="card-img-top img-fluid mb-4" src="{{ MEDIA_URL }}noimage.png" alt="{{ post.title }}">
            {% endif %}
            <!-- Post Content -->
            <p class="lead">{{ post.content }}</p>
            <hr>
            <!-- Comments Form -->
            <div class="card my-4 p-3">
               <p>{{ comments.count }} comments</p>
               <!-- Single Comment -->
               {% for comment in comments %}
               <div class="media mb-4">
                  <div class="container">
                     <h5 class="mt-0"> {{ comment.name }} | {{ comment.created_on }}</h5>
                     <p> {{ comment.body | linebreaks }}</p>
                  </div>
               </div>
               {% endfor %}
               {% if new_comment %}
               <div class="alert alert-success" role="alert">
                  Your comment is awaiting moderation
               </div>
               {% else %}
               <h5 class="card-header">Leave a Comment:</h5>
               <div class="card-body">
                  <form method="post" style="margin-top: 1.3em;">
                     {{ comment_form | crispy }}
                     {% csrf_token %}
                     <button type="submit" class="btn btn-primary  btn-lg">Submit</button>
                  </form>
               </div>
               {% endif %}
            </div>
         </div>
         <!-- Sidebar Widgets Column -->
         <div class="col-sm-3 col col-sm-offset-1 blog-sidebar">
            {% if request.user.is_authenticated %}
            <div class="sidebar-module">
               <h5 class="mb-3">User action</h5>
               <a href="{% url 'add_post' %}" class="add-post">Add a Post</a><br><br>
               {% if post.created_by == profile.user  %}
               <a href="{% url 'edit_post' post.id %}">Edit</a> | 
               <a class="text-danger" href="{% url 'delete_post' post.id %}">Delete</a>
               {% endif %}
            </div>
            {% endif %}
            <!-- Search Widget -->
            <div class="sidebar-module">
               <h5 >Search on the blog</h5>
               <div class="input-group">
                  <input type="text" class="form-control" placeholder="Search...">
                  <span class="input-group-append">
                  <button class="btn btn-secondary" type="button">Go!</button>
                  </span>
               </div>
            </div>
            <div class="sidebar-module sidebar-module-inset">
               <h4>About</h4>
               <p>Etiam porta <em>sem malesuada magna</em> mollis euismod. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur.</p>
            </div>
         </div>
         <!-- /.blog-sidebar -->
      </div>
      <!-- /.row -->
   </div>
</section>
{% endblock %}